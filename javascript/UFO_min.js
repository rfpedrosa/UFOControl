(function(a){function b(a,b,c,d){this.initialize(a,b,c,d)}var c=b.prototype=new Container;b.TYPE1=1;b.TYPE1_VEL=2;b.TYPE1_IMAGE=new Image;b.TYPE1_IMAGE.src="img/ufo/ufo1.png";b.TYPE2=2;b.TYPE2_VEL=1;b.TYPE2_IMAGE=new Image;b.TYPE2_IMAGE.src="img/ufo/ufo2.png";BLINK_TIME=500;c.type;c.bitmap;c.routeShape;c.routeColor;c.text;c.lastUFOShapeRadius=0;c.ufoShape;c.positions;c.hit;c.vel;c.isActive=false;c.isLanding=false;c.isAirportRouteTraced=false;c.isWarning=false;c.isToDelete=false;c.beforeActiveCounter;c.lastVisibleChangeDate;c.max_x;c.max_y;c.Shape_initialize=c.initialize;c.initialize=function(a,c,d,e){this.Shape_initialize();this.type=a;this.max_x=d;this.max_y=e;this.name=name;if(this.type==b.TYPE1){this.name="Nitro";this.vel=b.TYPE1_VEL;this.bitmap=new Bitmap(b.TYPE1_IMAGE);this.hit=this.bitmap.image.width/2|0;this.routeColor=Graphics.getRGB(203,128,70,.2)}else if(this.type==b.TYPE2){this.name="Turbo";this.vel=b.TYPE2_VEL;this.bitmap=new Bitmap(b.TYPE2_IMAGE);this.hit=this.bitmap.image.width/2|0;this.routeColor=Graphics.getRGB(219,192,113,.2)}this.bitmap.name=name;this.bitmap.regX=this.bitmap.image.width/2|0;this.bitmap.regY=this.bitmap.image.height/2|0;this.bitmap.scaleX=this.bitmap.scaleY=this.bitmap.scale=1;this.routeShape=new Shape;this.text=new Text(this.name,"bold 12px Arial","#FF0000");this.text.visible=false;this.addChild(this.bitmap);this.addChild(this.routeShape);this.addChild(this.text);this.ufoShape=new Shape;this.addChild(this.ufoShape);this.positions=new Array;this.isActive=false;this.beforeActiveCounter=c;this.lastVisibleChangeDate=new Date};c.mouseOver=function(){this.bitmap.scaleX=this.bitmap.scaleY=this.bitmap.scale*1.5;this.text.visible=true};c.mouseOut=function(){this.bitmap.scaleX=this.bitmap.scaleY=this.bitmap.scale;this.text.visible=false};c.setPosition=function(a,b){this.bitmap.x=a;this.bitmap.y=b;this.text.x=a;this.text.y=b};c.addRoutePoint=function(a,b){this.positions.push(new Point(a,b))};c.clearRoute=function(){this.routeShape.graphics.clear();this.positions.length=0};c.getLastPositions=function(a){var b=new Array;if(this.positions.length<a){return b}b=this.positions.slice(-a);return b};c.addRandomRoute=function(){var a=Math.round((this.max_x-200)*Math.random());var b=Math.round((this.max_y-200)*Math.random());if(a<200){a=200}if(b<200){b=200}x3=Math.round((this.bitmap.x+a)/2);y3=Math.round((this.bitmap.y+b)/2);this.addRoutePoint(x3,y3);this.addRoutePoint(a,b);this.setAirportRouteTraced(false)};c.drawRoute=function(a,b,c,d){this.routeShape.graphics.setStrokeStyle(10,"round","round").beginStroke(this.routeColor);this.routeShape.graphics.moveTo(a,b);this.routeShape.graphics.lineTo(c,d)};c.move=function(){if(!this.isActive&&this.beforeActiveCounter>0){var a=new Date;if(a.getTime()-this.lastVisibleChangeDate.getTime()>BLINK_TIME){this.bitmap.visible=!this.bitmap.visible;this.lastVisibleChangeDate=a}this.beforeActiveCounter--;this.drawUFOCircle(this.hit*2,this.routeColor,10);return}else if(!this.isActive&&!this.isLanding){this.bitmap.visible=true;this.bitmap.alpha=1;this.ufoShape.graphics.clear();this.isActive=true}if(this.positions.length<=0){if(!this.isLanding){this.clearRoute();this.addRandomRoute()}else{this.isToDelete=true;return}}var b=0;while(b<this.vel){var c=this.positions.shift();if(!c){break}if(c.x>this.bitmap.x){this.bitmap.x=this.bitmap.x+1}else if(c.x<this.bitmap.x){this.bitmap.x=this.bitmap.x-1}if(c.y>this.bitmap.y){this.bitmap.y=this.bitmap.y+1}else if(c.y<this.bitmap.y){this.bitmap.y=this.bitmap.y-1}this.setPosition(this.bitmap.x,this.bitmap.y);if(this.bitmap.x!=c.x||this.bitmap.y!=c.y){this.positions.unshift(c)}xDiff=c.x-this.bitmap.x;yDiff=c.y-this.bitmap.y;b++}};c.hitPoint=function(a,b){return this.hitRadius(a,b,0)};c.hitRadius=function(a,b,c){return hitRadius(this.bitmap.x,this.bitmap.y,this.hit,a,b,c)};c.hitRectangle=function(a){return hitRectangle(this.bitmap.x,this.bitmap.y,a)};c.land=function(a){this.isActive=false;this.ufoShape.graphics.clear();this.lastUFOShapeRadius=this.hit;this.isLanding=true;this.vel=1;this.bitmap.scaleX=this.bitmap.scaleY=this.bitmap.scale=.5;this.clearRoute();for(index in a){var b=a[index];this.addRoutePoint(b.x,b.y)}};c.setAirportRouteTraced=function(a){if(this.isAirportRouteTraced!=a){this.isAirportRouteTraced=a;if(this.isAirportRouteTraced&&!this.isWarning){this.ufoShape.graphics.clear()}else if(!this.isAirportRouteTraced&&!this.isWarning){}}};c.changeToWarningMode=function(a){this.isWarning=true;this.drawUFOCircle(this.hit*4,Graphics.getRGB(255,0,0,1),1)};c.changeToNormalMode=function(){this.isWarning=false;this.ufoShape.graphics.clear()};c.explode=function(){this.ufoShape.graphics.clear();this.ufoShape.graphics.beginFill("#FFFF00");this.ufoShape.graphics.moveTo(this.bitmap.x,this.bitmap.y);var a=this.bitmap.image.width;var b=0;var c=a;while(b<Math.PI*2-.5){b+=.25+Math.random()*100/500;c=a+a/2*Math.random();this.ufoShape.graphics.lineTo(this.bitmap.x+Math.sin(b)*c,this.bitmap.y+Math.cos(b)*c)}this.ufoShape.graphics.endFill()};c.drawUFOCircle=function(a,b,c){this.ufoShape.graphics.clear();this.lastUFOShapeRadius+=2;if(this.lastUFOShapeRadius>a){this.lastUFOShapeRadius=this.hit}this.ufoShape.graphics.setStrokeStyle(c).beginStroke(b);this.ufoShape.graphics.drawCircle(this.bitmap.x,this.bitmap.y,this.lastUFOShapeRadius)};a.UFO=b})(window)